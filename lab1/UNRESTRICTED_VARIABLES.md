# Поддержка неограниченных переменных

## Что это значит?

В стандартной задаче линейного программирования все переменные должны быть неотрицательными: \( x_i \geq 0 \).

Но иногда переменная может принимать **любое значение** (в том числе отрицательное). Такие переменные называются **неограниченными** (unrestricted).

## Как это работает?

Если переменная \( x_i \) может быть любого знака, мы заменяем её на **разность двух неотрицательных** переменных:

\[ x_i = x_i^+ - x_i^- \]

где \( x_i^+ \geq 0 \) и \( x_i^- \geq 0 \).

Например:
- Если \( x_2 = 5 \), то \( x_2^+ = 5, x_2^- = 0 \)
- Если \( x_2 = -3 \), то \( x_2^+ = 0, x_2^- = 3 \)
- Если \( x_2 = 0 \), то \( x_2^+ = 0, x_2^- = 0 \)

## Формат файла

Добавьте строку `unrestricted` после ограничений:

### Вариант 1: Конкретные переменные

```
maximize
3 2 -1
1 1 1 <= 10
2 -1 1 <= 8
-1 2 1 >= 2
unrestricted 2
```

Здесь только **x2** может быть отрицательной.

### Вариант 2: Несколько переменных

```
minimize
2 -3 1
1 1 0 <= 4
-1 2 1 = 6
unrestricted 1 2
```

Здесь **x1 и x2** могут быть отрицательными.

### Вариант 3: Все переменные

```
maximize
1 2 3
1 0 1 <= 5
0 1 1 <= 4
unrestricted all
```

Здесь **все переменные** (x1, x2, x3) могут быть отрицательными.

### Вариант 4: Без неограниченных (по умолчанию)

```
minimize
4 1 1 2
2 1 0 1 <= 9
1 1 1 0 = 7
0 0 1 1 >= 5
```

Если нет строки `unrestricted`, все переменные \( \geq 0 \) (стандартное поведение).

## Примеры

### Пример 1: Задача с одной неограниченной переменной

**Файл:** `test_unrestricted2.txt`

```
maximize
3 2 -1
1 1 1 <= 10
2 -1 1 <= 8
-1 2 1 >= 2
unrestricted 2
```

**Решение:**
```
x1 = 6.00
x2 = 4.00  ← может быть отрицательной!
x3 = 0.00
Z = 26.00
```

### Пример 2: Задача с двумя неограниченными переменными

**Файл:** `test_unrestricted.txt`

```
minimize
2 -3 1
1 1 0 <= 4
-1 2 1 = 6
unrestricted 1 2
```

**Результат:** Задача неограничена (Z → -∞)

## Как запустить

```bash
# Активировать виртуальное окружение
source venv/bin/activate

# Запустить с неограниченными переменными
python3 simplex_solver.py test_unrestricted2.txt

# С детальным выводом
python3 simplex_solver_detailed.py test_unrestricted2.txt
```

## Вывод программы

Программа покажет:

1. **Парсинг:**
   ```
   [Парсинг]: Неограниченные переменные: x2
   ```

2. **Замена переменных:**
   ```
   [Замена переменных]: Обработка 1 неограниченных переменных
     x2 = x2+ - x2-
   ```

3. **Решение:**
   ```
   Оптимальная точка:
   x1 = 6.00
   x2 = 4.00  ← автоматически вычислено как x2+ - x2-
   x3 = 0.00
   ```

## Технические детали

### Преобразование целевой функции

Если \( Z = c_1 x_1 + c_2 x_2 + c_3 x_3 \) и \( x_2 \) неограничена:

\[ Z = c_1 x_1 + c_2 (x_2^+ - x_2^-) + c_3 x_3 = c_1 x_1 + c_2 x_2^+ - c_2 x_2^- + c_3 x_3 \]

### Преобразование ограничений

Если \( a_1 x_1 + a_2 x_2 + a_3 x_3 \leq b \) и \( x_2 \) неограничена:

\[ a_1 x_1 + a_2 (x_2^+ - x_2^-) + a_3 x_3 \leq b \]
\[ a_1 x_1 + a_2 x_2^+ - a_2 x_2^- + a_3 x_3 \leq b \]

## Ограничения

- Номера переменных указываются в **1-based** формате (x1, x2, x3, ...)
- Строка `unrestricted` должна быть **после** всех ограничений
- Можно использовать только **один раз**
- Если переменная неограничена, в таблице появятся `x_i+` и `x_i-`, но в финальном ответе будет показана исходная `x_i`

## Совместимость

✅ Работает с `simplex_solver.py`
⚠️  Требует обновления `simplex_solver_detailed.py` (в процессе)
⚠️  Требует обновления `simplex_solver_lib.py` для сравнения (в процессе)
