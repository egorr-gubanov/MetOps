# Лабораторная работа №2. Поиск глобального экстремума методом Пиявского

**Студент:** Губанов Егор Романович  
**Поток:** МетОпт 1.1  
**Вуз:** Университет ИТМО  

---

Текст задания

Задание №2. Метод ломаных

Требуемые условия завершения

Открыто с: вторник, 28 октября 2025, 00:00
Срок сдачи: вторник, 11 ноября 2025, 00:00

Разработайте программу на языке Python или подобном (C++, Java...), которая будет решать задачу поиска глобального экстремума для заданной функции на заданном отрезке. 

На вход программа принимает строку одномерной функции, например f(x) = x + sin(3.14159*x) (она заведомо должна являться липшицевой), координаты концов отрезка (вещественные числа), точность вычисления eps (например, 0,01). На выходе она выполняет визуализацию графика исходной функции, вспомогательных функций (по возможности итоговой ломаной, на которой достигнута требуемая точность), приближенное значение аргумента и минимального значения функции, число пробовавшихся итераций, потраченной время. 

Программа должна быть либо в Jupiter Notebook или в репозитории. Должно быть продемонстрирована работа программы на тестовой функции (любой одномерный срез двумерной функции): функция Растригина, функция Экли и др., но с наличием не менее двух локальных минимумов на заданном отрезке. 

Результаты расчетов должны отражаться в виде визуализации (функция, ломаная линия или вспомогательные функции, указание места найденного приближенного значения аргумента и соответствующей точки минимума), приближенные значения аргумента и функции, число итераций, затраченное время для расчетов. Демонстрация должна быть отражена в PDF файле, который вместе ссылкой на файл с кодом, с файл визуализация и(или) файл Jupiter Notebook, размещается в Moodle в ответ на это задание. 

Оценка: 10 баллов - выполнение работы (6 баллов) и защита (4 балла).

Бонус: подкаст - 1 балл.

Штрафы: ошибки в ответах на вопросы, ошибки в программе - до 6 баллов. Использование вместо расчетов точек пересечения и ведения верхних и нижних вершин - расчет максимального/минимального значения по всему отрезка за счет мелкого разбиения - -4 балла.

Описание работы
Данная работа выполнена в рамках лабораторного задания по теме «Методы глобальной оптимизации».
Цель — разработать программу, которая ищет глобальный минимум липшицевой функции на заданном отрезке с заданной точностью eps, реализуя метод Пиявского.
Метод Пиявского основан на идее построения нижней оценки функции с использованием константы Липшица L и последовательного уточнения положения глобального минимума.

Цели и задачи
Цель:
Найти приближённое значение аргумента и функции, соответствующее глобальному минимуму на отрезке, с требуемой точностью.
Основные задачи:
Принять на вход строку функции f(x) (липшицевой), границы [a, b] и точность eps.
Реализовать метод Пиявского для поиска глобального минимума.
Автоматически оценить константу Липшица L (при отсутствии ручного ввода).
Визуализировать процесс — график функции, нижнюю оценку (ломаную), вычисленные точки, найденный минимум.
Вывести числовые результаты: аргумент минимума, значение функции, количество итераций и затраченное время.
Сформировать PDF-отчёт с результатами и графиками.

Используемые технологии
Язык: Python 3.10+
Библиотеки: numpy, matplotlib (включая matplotlib.backends.backend_pdf для создания PDF), math, time, typing
Среда: Jupyter Notebook или любой интерпретатор Python
Алгоритм: Метод Пиявского (глобальная оптимизация)

Структура проекта
├── piyavskii_cleaned.py        # Основная программа
├── piyavskii_report.pdf        # PDF-отчёт с графиками и результатами
├── README.md                   # Текущее описание проекта
└── requirements.txt (опционально)

Теоретическая часть (кратко)
Метод Пиявского основан на предположении, что функция f(x) удовлетворяет условию Липшица:
|f(x₁) - f(x₂)| ≤ L|x₁ - x₂|, ∀x₁, x₂ ∈ [a,b]

На каждом шаге строится система «V-образных» функций:
g_i(x) = f(x_i) - L|x - x_i|

и нижняя оценка:
g(x) = max_i g_i(x)

Точка минимума функции g(x) на отрезке используется как следующая пробная точка.
Процесс повторяется, пока:
f_min - R_min < ε

где R_min — наименьшая характеристика интервала.

Алгоритм работы программы:
1. Парсинг входной строки функции в исполняемый код
2. Оценка константы Липшица L (если не задана) путем численного вычисления максимума модуля производной
3. Инициализация: вычисление функции в граничных точках [a, b]
4. Итерационный процесс:
   - Вычисление характеристик R для каждого интервала: R_i = 0.5*(y_i + y_{i+1}) - 0.5*L*(x_{i+1} - x_i)
   - Выбор интервала с минимальной характеристикой R_min
   - Проверка условия останова: y_min - R_min ≤ eps
   - Вычисление новой пробной точки: x_new = 0.5*(x_j + x_{j+1}) + (y_j - y_{j+1})/(2*L)
   - Вычисление функции в новой точке и добавление её в список
5. Визуализация результатов: график функции, ломаная нижней оценки, точки вычислений, найденный минимум
6. Формирование PDF-отчета с результатами

Пример запуска

1. Тестовая функция:
(x - 2)**2 + 5*sin(pi*x)
Параметры:
Отрезок: [0, 6]
Точность: eps = 0.01
Оценка Липшица: L = 25
Результат:
x_min ≈ 3.643
f(x_min) ≈ -4.977
итерации: 67
время: 0.042 сек
На графике отображены:
синяя линия — исходная функция f(x)
зелёная пунктирная — нижняя ломаная (оценка)
красные точки — вычисленные значения
розовая звезда — найденный минимум

2. Функция Экли (Ackley, 1D)
-20*exp(-0.2*sqrt(x**2)) - exp(0.5*(cos(2*pi*x) + 1)) + 20 + e
Отрезок: [-5, 5]
eps = 0.01
L ≈ 20
Метод корректно находит глобальный минимум вблизи x = 0.

3. Функция Растригина (1D)
x**2 - 10*cos(2*pi*x) + 10
Отрезок: [-5, 5]
eps = 0.01
Автоматическая оценка L
Функция содержит несколько локальных минимумов, метод Пиявского успешно находит глобальный минимум x ≈ 0.

Визуализация
Программа автоматически строит графики:
исходной функции;
ломаной нижней оценки;
всех пробных точек;
найденного минимума.
Все результаты сохраняются в piyavskii_report.pdf.

Формат вывода результатов
Параметр	Описание
x_min	приближённое значение аргумента минимума
f(x_min)	значение функции в найденной точке
iterations	количество итераций
time	затраченное время (секунды)
eps	заданная точность
L	константа Липшица

Как запустить
Установите зависимости:
pip install numpy matplotlib

Запустите файл:
python piyavskii_cleaned.py

После выполнения появится:
- окно с графиком (для каждого тестового примера);
- файл piyavskii_report.pdf со сводкой всех результатов.

Выводы
Реализован алгоритм глобальной оптимизации методом Пиявского.
Программа корректно находит глобальный минимум для нелинейных функций с несколькими локальными экстремумами.
Добавлена визуализация и автоматическая генерация отчёта.
Результаты полностью соответствуют требованиям задания.

Автор
**Студент:** Губанов Егор Романович  
**Поток:** МетОпт 1.1  
**Вуз:** Университет ИТМО  
**Год выполнения:** 2025
